Claire Ruffing
CSE180 Lab 2
May 1, 2020

Script started on Fri May  1 19:58:11 2020
psql -h cse180-db-spring.lt.ucsc.edu -U cmruffin

SELECT *
FROM Actors
WHERE birthyear < 1960;

 actorid |         name          | gender | birthyear 
---------+-----------------------+--------+-----------
       0 | Kurt Russell          | Male   |      1951
       1 | Sigourney Weaver      | Female |      1949
       2 | Linda Hamilton        | Female |      1956
       3 | Michael Biehn         | Male   |      1956
       4 | Arnold Schwarzenegger | Male   |      1947
       5 | Bill Murray           | Male   |      1950
(6 rows)

SELECT *
FROM Actors
LEFT JOIN MovieRoles on MovieRoles.actorid BETWEEN 4 AND 8 AND Actors.actorid BETWEEN 4 AND 8 AND MovieRoles.actorid = Actors.actorid
WHERE role IN (SELECT role FROM MovieRoles);

 actorid |         name          | gender | birthyear | actorid | movieid |       role        
---------+-----------------------+--------+-----------+---------+---------+-------------------
       4 | Arnold Schwarzenegger | Male   |      1947 |       4 |       5 | Terminator
       5 | Bill Murray           | Male   |      1950 |       5 |       7 | Bill Murray
       5 | Bill Murray           | Male   |      1950 |       5 |       6 | Dr. Peter Venkman
       7 | Emma Stone            | Female |      1988 |       7 |       9 | Jules
(4 rows)

SELECT name 
FROM Actors
WHERE EXISTS (SELECT role 
FROM MovieRoles
WHERE Actors.actorid BETWEEN 4 AND 8 AND actors.actorid = MovieRoles.actorid);

         name          
-----------------------
 Arnold Schwarzenegger
 Bill Murray
 Emma Stone
(3 rows)

SELECT title
FROM Movies, Reviews, Imdb
WHERE Reviews.rating > 7.5 AND imdb.imdb_rating > 7.5 AND movies.movieid = Reviews.movieid AND Movies.movieid = Imdb.movieid;

     title      
----------------
 The Thing
 1917
 Jurassic Park
 The Terminator
 Ghostbusters
 Zombieland
(6 rows)

SELECT DISTINCT ON (title) title
FROM Movies, Reviews
WHERE Reviews.review_text LIKE '%' || Movies.title || '%';

     title     
---------------
 1917
 Alien
 Ghostbusters
 Jurassic Park
 The Thing
(5 rows)

SELECT DISTINCT ON (name) name, director
FROM Actors, Movies, MovieRoles
WHERE Actors.actorid = MoviesRoles.actorid AND Movies.movieid = MovieRoles.movieid AND director IN (SELECT director 
FROM (SELECT director, COUNT(name) as n
FROM Movies, Actors, MovieRoles
WHERE Actors.actorid = MovieRoles.actorid AND Movies.movieid = MovieRoles.movieid
GROUP BY director) as d
WHERE d.n > 1);

         name          |   director    
-----------------------+---------------
 Arnold Schwarzenegger | James Cameron
 Jude Law              | Guy Ritchie
 Linda Hamilton        | James Cameron
 Michael Biehn         | James Cameron
 Rachel McAdams        | Guy Ritchie
(5 rows)

SELECT name, title
FROM Actors, Movies, MovieRoles
WHERE Actors.name = MovieRoles.role AND Movies.movieid = MovieRoles.movieid;

    name     |   title    
-------------+------------
 Bill Murray | Zombieland
(1 row)

SELECT title
FROM Movies
WHERE Movies.genre LIKE '%Action%' OR Movies.genre LIKE '%Adventure%' OR Movies.genre LIKE '%Crime%';

               title                
------------------------------------
 Jurassic Park
 The Terminator
 Ghostbusters
 Zombieland
 Sherlock Holmes: A Game of Shadows
(5 rows)

SELECT title
FROM Movies 
WHERE Movies.genre LIKE '%Horror%' AND Movies.genre LIKE '%Comedy%';

   title    
------------
 Zombieland
(1 row)

SELECT name
FROM actors
WHERE Actors.name LIKE '% H%';

      name       
-----------------
 Linda Hamilton
 Woody Harrelson
 Jonah Hill
(3 rows)

SELECT name
FROM Actors, Movies, MovieRoles
WHERE Actors.actorid = MovieRoles.actorid AND Movies.movieid = MovieRoles.movieid AND Movies.title = 'The Terminator' AND role IN (SELECT role  FROM MovieRoles);

         name          
-----------------------
 Arnold Schwarzenegger
 Michael Biehn
 Linda Hamilton
(3 rows)

SELECT title, imdb_rating
FROM Movies, Imdb
WHERE Movies.movieid = Imdb.movieid
ORDER BY imdb_rating;

               title                | imdb_rating 
------------------------------------+-------------
 The Thing                          |         6.2
 Sherlock Holmes: A Game of Shadows |         7.5
 Superbad                           |         7.6
 Zombieland                         |         7.6
 Ghostbusters                       |         7.8
 The Terminator                     |           8
 The Thing                          |         8.1
 Jurassic Park                      |         8.1
 Alien                              |         8.4
 1917                               |         8.4
(10 rows)

SELECT DISTINCT ON (role) role
FROM MovieRoles
JOIN Actors ON gender = 'Male'
JOIN Movies ON Movies.movieid = MovieRoles.movieid
WHERE year < 2000
ORDER BY role;

       role        
-------------------
 Dr. Peter Venkman
 Kyle Reese
 MacReady
 Ripley
 Sarah Connor
 Terminator
(6 rows)

cmruffin=> \q
bash-4.2$ exit

Script done on Fri May  1 20:38:43 2020
