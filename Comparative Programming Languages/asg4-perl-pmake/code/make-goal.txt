
pseudocode:

make_goal is a recursive function

make_goal goal
    if this goal has already been visited, return,
        otherwise mark it as having been visited and continue.
    if goal is not a target:
        if goal is a file return its modtime
        else stop with error "don't know how..."
    else it is a target.

    for each prereq:
        call make_goal recursively with that prereq
        remember the newest prereq modtime
        if no prereqs, the newest modtime is 0

    run the commands if either of the following is true:
        the target file does not exist
        or the newest prereq is newer than the target modtime

running a command:
    perform macro substitution on the command
    if the command does not begin with "@", print it
    call run_command
    if run_command returns undef, return 
    print the message:
        if the command begins with "-" use (ignored), return
        if not, print the message and exit 1


